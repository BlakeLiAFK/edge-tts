<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edge TTS Studio</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Edge TTS Studio</h1>
            <p class="subtitle">Microsoft Edge TTS</p>
        </header>

        <main class="main">
            <!-- 语言和音色选择 -->
            <div class="voice-section">
                <div class="select-group">
                    <label for="language-select">语言</label>
                    <select id="language-select">
                        <option value="">加载中...</option>
                    </select>
                </div>
                <div class="select-group voice-select-group">
                    <label for="voice-select">音色</label>
                    <div class="voice-select-wrapper">
                        <select id="voice-select">
                            <option value="">请先选择语言</option>
                        </select>
                        <button id="sample-btn" class="icon-btn" title="试听音色">
                            <span class="icon">&#9834;</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- 文本输入 -->
            <div class="text-section">
                <label for="text-input">文本内容</label>
                <textarea id="text-input" placeholder="请输入要转换的文本..." maxlength="5000"></textarea>
                <div class="char-count"><span id="char-count">0</span> / 5000</div>
            </div>

            <!-- 参数调整 -->
            <div class="params-section">
                <div class="param-group">
                    <label>语速</label>
                    <div class="slider-wrapper">
                        <input type="range" id="rate-slider" min="-50" max="100" value="0">
                        <span id="rate-value" class="param-value">正常</span>
                    </div>
                </div>
                <div class="param-group">
                    <label>音调</label>
                    <div class="slider-wrapper">
                        <input type="range" id="pitch-slider" min="-50" max="50" value="0">
                        <span id="pitch-value" class="param-value">正常</span>
                    </div>
                </div>
            </div>

            <!-- 字幕选项 -->
            <div class="srt-section">
                <label class="checkbox-label">
                    <input type="checkbox" id="srt-checkbox">
                    <span>同时生成 SRT 字幕文件</span>
                </label>
            </div>

            <!-- 操作按钮 -->
            <div class="action-section">
                <button id="preview-btn" class="btn btn-secondary">
                    <span class="btn-icon">&#9654;</span>
                    <span>预览</span>
                </button>
                <button id="download-btn" class="btn btn-primary">
                    <span class="btn-icon">&#8595;</span>
                    <span>下载 MP3</span>
                </button>
            </div>

            <!-- 音频播放器 -->
            <div class="player-section" id="player-section" style="display: none;">
                <audio id="audio-player" controls></audio>
            </div>

            <!-- 加载状态 -->
            <div class="loading-overlay" id="loading-overlay" style="display: none;">
                <div class="loading-spinner"></div>
                <p id="loading-text">正在合成...</p>
            </div>
        </main>

        <!-- 历史记录 -->
        <aside class="history-section">
            <div class="history-header">
                <h3>历史记录</h3>
                <button id="clear-history-btn" class="text-btn">清空</button>
            </div>
            <div class="history-list" id="history-list">
                <p class="history-empty">暂无历史记录</p>
            </div>
        </aside>

        <!-- API 文档 -->
        <section class="api-section">
            <div class="api-header" id="api-header">
                <h3>API 接口文档</h3>
                <span class="toggle-icon">&#9660;</span>
            </div>
            <div class="api-content" id="api-content">
                <!-- 获取语音列表 -->
                <div class="api-item">
                    <h4>获取语音列表</h4>
                    <div class="api-endpoint">
                        <span class="method get">GET</span>
                        <code>/api/voices</code>
                    </div>
                    <div class="code-block">
                        <button class="copy-btn" data-target="code-voices">复制</button>
                        <pre id="code-voices">curl -X GET <span class="api-host"></span>/api/voices</pre>
                    </div>
                    <p class="api-desc">返回所有可用语音列表，按语言分组。</p>
                </div>

                <!-- 文本转语音 -->
                <div class="api-item">
                    <h4>文本转语音</h4>
                    <div class="api-endpoint">
                        <span class="method post">POST</span>
                        <code>/api/tts</code>
                    </div>
                    <div class="code-block">
                        <button class="copy-btn" data-target="code-tts">复制</button>
                        <pre id="code-tts">curl -X POST <span class="api-host"></span>/api/tts \
  -H "Content-Type: application/json" \
  -d '{
    "text": "你好，这是一段测试文本",
    "voice": "zh-CN-XiaoxiaoNeural",
    "rate": "+0%",
    "volume": "+0%",
    "pitch": "+0Hz"
  }' \
  --output output.mp3</pre>
                    </div>
                    <div class="api-params">
                        <table>
                            <thead>
                                <tr><th>参数</th><th>类型</th><th>说明</th></tr>
                            </thead>
                            <tbody>
                                <tr><td>text</td><td>string</td><td>要转换的文本（必填）</td></tr>
                                <tr><td>voice</td><td>string</td><td>语音ID，如 zh-CN-XiaoxiaoNeural</td></tr>
                                <tr><td>rate</td><td>string</td><td>语速，范围 -100% ~ +100%</td></tr>
                                <tr><td>volume</td><td>string</td><td>音量，范围 -100% ~ +100%</td></tr>
                                <tr><td>pitch</td><td>string</td><td>音调，范围 -50Hz ~ +50Hz</td></tr>
                                <tr><td>subtitle</td><td>bool</td><td>是否返回 SRT 字幕</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 带字幕的转换 -->
                <div class="api-item">
                    <h4>带字幕的转换</h4>
                    <div class="api-endpoint">
                        <span class="method post">POST</span>
                        <code>/api/tts</code>
                    </div>
                    <div class="code-block">
                        <button class="copy-btn" data-target="code-tts-srt">复制</button>
                        <pre id="code-tts-srt">curl -X POST <span class="api-host"></span>/api/tts \
  -H "Content-Type: application/json" \
  -d '{
    "text": "你好，这是一段测试文本",
    "voice": "zh-CN-YunxiNeural",
    "rate": "+20%",
    "subtitle": true
  }' \
  --output output.zip</pre>
                    </div>
                    <p class="api-desc">当 subtitle=true 时，返回 ZIP 文件，包含 audio.mp3 和 subtitle.srt。</p>
                </div>

                <!-- 语音预览 -->
                <div class="api-item">
                    <h4>语音预览</h4>
                    <div class="api-endpoint">
                        <span class="method get">GET</span>
                        <code>/api/voices/{voiceId}/sample</code>
                    </div>
                    <div class="code-block">
                        <button class="copy-btn" data-target="code-sample">复制</button>
                        <pre id="code-sample">curl -X GET <span class="api-host"></span>/api/voices/zh-CN-XiaoxiaoNeural/sample \
  --output sample.mp3</pre>
                    </div>
                    <p class="api-desc">获取指定语音的示例音频。</p>
                </div>

                <!-- 更多示例 -->
                <div class="api-item">
                    <h4>更多示例</h4>
                    <div class="code-block">
                        <button class="copy-btn" data-target="code-more">复制</button>
                        <pre id="code-more"># 英语语音
curl -X POST <span class="api-host"></span>/api/tts \
  -H "Content-Type: application/json" \
  -d '{"text": "Hello World", "voice": "en-US-AriaNeural"}' \
  --output hello.mp3

# 日语语音，加快语速
curl -X POST <span class="api-host"></span>/api/tts \
  -H "Content-Type: application/json" \
  -d '{"text": "こんにちは", "voice": "ja-JP-NanamiNeural", "rate": "+30%"}' \
  --output japanese.mp3

# 粤语语音
curl -X POST <span class="api-host"></span>/api/tts \
  -H "Content-Type: application/json" \
  -d '{"text": "你好", "voice": "zh-HK-HiuGaaiNeural"}' \
  --output cantonese.mp3</pre>
                    </div>
                </div>
            </div>
        </section>

        <footer class="footer">
            <p>Powered by Microsoft Edge TTS</p>
        </footer>
    </div>

    <script src="/js/app.js"></script>
</body>
</html>
